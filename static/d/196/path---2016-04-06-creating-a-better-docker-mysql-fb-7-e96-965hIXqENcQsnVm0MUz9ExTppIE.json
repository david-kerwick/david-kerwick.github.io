{"data":{"site":{"siteMetadata":{"title":"Random Stuff About Stuff","author":"David Kerwick"}},"markdownRemark":{"id":"51e61561-5bca-528a-9c76-e5394df071d7","excerpt":"So having played with Docker and the mysql images before it’s time to create something that’s less of a disposable test. The idea is to create a mysql instance…","html":"<p>So having played with Docker and the mysql images before it’s time to create something that’s less of a disposable test.</p>\n<p>The idea is to create a mysql instance, preload it with a test database and have a custom mysql config as well.</p>\n<p>All will be based off the official Docker image so not to difficult.</p>\n<p>Let’s start with the Dockerfile and then go through it</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">FROM mysql:5.7.11\nRUN apt-get update &amp;&amp; apt-get install -y vim\n\nCOPY mydb.sql /docker-entrypoint-initdb.d/\nCOPY my-config.cnf /etc/mysql/conf.d/\n\nVOLUME /var/lib/mysql</code></pre></div>\n<p><code class=\"language-text\">FROM mysql:5.7.11</code> the base image.  Picking a tag is a good idea that way you get the same version each time.</p>\n<p><code class=\"language-text\">RUN apt-get update &amp;&amp; apt-get install -y vim</code> installs vi, the base image doesn’t have a text editor and I wanted one</p>\n<p><code class=\"language-text\">COPY mydb.sql /docker-entrypoint-initdb.d/</code> mydb.sql is your local file that creates your database, tables, etc…</p>\n<p><code class=\"language-text\">COPY my-config.cnf /etc/mysql/conf.d/</code> my-config.cnf is your local file that overrides any of the normal my.cnf mysql stuff that you want.\nFor example I had to do it for <a href=\"%7B%7B%20site.baseurl%20%7D%7D../2016-04-06-group-by-error-when-updating-mysql\">this problem</a></p>\n<p>Once you have your Dockerfile, your local db and config file you can go to that directory and run</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker build -t test-sql <span class=\"token keyword\">.</span></code></pre></div>\n<p>The <code class=\"language-text\">-t test-sql</code> tags this build so you can use it later.  It will trundle away and build the image.</p>\n<p>Once done you can use it as a base for a container.\nFor example</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run -d --name container-mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD<span class=\"token operator\">=</span>password test-sql</code></pre></div>\n<p>That should have created the database with your config and you should be good to go.</p>","frontmatter":{"title":"Creating a better Docker mysql","date":"April 06, 2016"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2016-04-06-creating-a-better-docker-mysql/","previous":{"fields":{"slug":"/2016-04-06-group-by-error-when-updating-mysql/"},"frontmatter":{"title":"Group By error when updating mysql"}},"next":{"fields":{"slug":"/2016-04-06-docker-dangling-volumes/"},"frontmatter":{"title":"Docker Dangling Volumes"}}}}