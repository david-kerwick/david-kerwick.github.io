{"data":{"site":{"siteMetadata":{"title":"Random Stuff About Stuff","author":"David Kerwick"}},"markdownRemark":{"id":"189fe715-7877-56d8-9fa3-0ce12fcfebbb","excerpt":"Having got individual docker containers up and running doing simple enough things like serving a html page, basic phpinfo and a mysql server it’s time to try…","html":"<p>Having got individual docker containers up and running doing simple enough things like serving a html page, basic phpinfo and a mysql server it’s time to try and tie these things together.</p>\n<p>The idea is two containers one with apache/php and the other a mysql server and have one talk to the other.</p>\n<p>So a few things more than the basics, need to link containers and there’s a bit more setup this time, the php server will need the mysql drivers installed, mysql should init a database, etc…</p>\n<h1>Apache / PHP</h1>\n<p>As mentioned this needs mysql drivers and other config I have a dockerfile and blog post about it <a href=\"../2016-04-07-creating-a-better-docker-php\">Creating a better Docker PHP</a></p>\n<h1>MySql</h1>\n<p>I created a dockerfile for this that preloads the database based off a sql file etc… blog post about it <a href=\"../2016-04-06-creating-a-better-docker-mysql\">Creating a better Docker Mysql</a></p>\n<h1>Tying it together</h1>\n<p>To tie it together I’m going to use Docker Compose, sure seems like the correct fit.\nIt will build and start both servers, in the correct order and link them.</p>\n<p>Create a docker-compose.yml</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'2'</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">php</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./php<span class=\"token punctuation\">-</span>server\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> php<span class=\"token punctuation\">-</span>img\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"80:80\"</span>\n    <span class=\"token key atrule\">links</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> an<span class=\"token punctuation\">-</span>mysql<span class=\"token punctuation\">:</span>an<span class=\"token punctuation\">-</span>mysql\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./php<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">:</span>/var/www/html\n  <span class=\"token key atrule\">an-mysql</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./sql\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mysql<span class=\"token punctuation\">-</span>img\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"3306:3306\"</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> MYSQL_ROOT_PASSWORD=password</code></pre></div>\n<p>Basically is takes the normal docker run commands and puts them in the yaml structure.</p>\n<p>To run go to the directory with the compose file and run</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker-compose up</code></pre></div>\n<p>First time it runs it will build the two containers and start them\nYou can check up on them by running</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker-compose <span class=\"token function\">ps</span></code></pre></div>\n<p>Stop them with </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker-compose stop</code></pre></div>\n<p>And many more see the <a href=\"https://docs.docker.com/compose/reference/overview/\">docs</a></p>","frontmatter":{"title":"Docker tying a php server and mysql server together for development","date":"April 07, 2016"}}},"pageContext":{"slug":"/2016-04-07-docker-tying-a-php-server-and-mysql-server-together-for-development/","previous":{"fields":{"slug":"/2016-04-07-creating-a-better-docker-php/"},"frontmatter":{"title":"Creating a better docker php"}},"next":{"fields":{"slug":"/2016-04-07-phpstorm-and-codeigniter/"},"frontmatter":{"title":"PHPStorm and Codeigniter"}}}}