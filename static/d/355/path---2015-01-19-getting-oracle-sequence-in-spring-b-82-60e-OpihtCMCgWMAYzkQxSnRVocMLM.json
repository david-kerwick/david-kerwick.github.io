{"data":{"site":{"siteMetadata":{"title":"Random Stuff About Stuff","author":"David Kerwick"}},"markdownRemark":{"id":"1bff19ff-8c78-5907-8962-8b4926a2d184","excerpt":"Ok so this one is a bit of lead in but no harm in it by itself. If you are using Spring and want to get the next value from an Oracle sequence you can do…","html":"<p>Ok so this one is a bit of lead in but no harm in it by itself.<br>\nIf you are using Spring and want to get the next value from an Oracle sequence you can do something like this.  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">javax<span class=\"token punctuation\">.</span>sql</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">DataSource</span><span class=\"token punctuation\">;</span>  \n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>slf4j</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Logger</span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>annotation</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Autowired</span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>incrementer</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">OracleSequenceMaxValueIncrementer</span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>stereotype</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Repository</span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>transaction<span class=\"token punctuation\">.</span>annotation</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Transactional</span><span class=\"token punctuation\">;</span>  \n\n<span class=\"token annotation punctuation\">@Repository</span>  \n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MessageIdSeqDaoImpl</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MessageIdSeqDao</span> <span class=\"token punctuation\">{</span>  \n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Logger</span>  logger          <span class=\"token operator\">=</span> org<span class=\"token punctuation\">.</span>slf4j<span class=\"token punctuation\">.</span><span class=\"token class-name\">LoggerFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MessageIdSeqDaoImpl</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span>  MESSAGE_ID <span class=\"token operator\">=</span> <span class=\"token string\">\"message_id\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">transient</span> <span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">;</span>  \n\n    <span class=\"token annotation punctuation\">@Autowired</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setDataSource</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataSource <span class=\"token operator\">=</span> dataSource<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n\n    <span class=\"token annotation punctuation\">@Transactional</span><span class=\"token punctuation\">(</span>readOnly <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">OracleSequenceMaxValueIncrementer</span> incr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OracleSequenceMaxValueIncrementer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataSource<span class=\"token punctuation\">,</span> MESSAGE_ID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">int</span> messageId <span class=\"token operator\">=</span> incr<span class=\"token punctuation\">.</span><span class=\"token function\">nextIntValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        logger<span class=\"token punctuation\">.</span><span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sequence nextval = '{}'\"</span><span class=\"token punctuation\">,</span> messageId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> messageId<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>  </code></pre></div>\n<p>This is a basic wrapper that uses the Spring class <code class=\"language-text\">OracleSequenceMaxValueIncrementer</code> to get the sequence, as you can see you pass in the datasource and the name of the sequence.\nIn this case the sequence is an int hence the <code class=\"language-text\">nextIntValue</code> method there’s also one for long and String.  </p>\n<p>Short and sweet now if you wanted to get them in bulk…</p>","frontmatter":{"title":"Getting an Oracle Sequence in Spring","date":"January 19, 2015"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2015-01-19-getting-oracle-sequence-in-spring/","previous":{"fields":{"slug":"/2015-01-19-http-400-error-submitting-form-with/"},"frontmatter":{"title":"Http 400 Error Submitting a Form With Errors With Spring"}},"next":{"fields":{"slug":"/2015-01-19-getting-oracle-sequences-in-bulk/"},"frontmatter":{"title":"Getting Oracle Sequences in bulk"}}}}