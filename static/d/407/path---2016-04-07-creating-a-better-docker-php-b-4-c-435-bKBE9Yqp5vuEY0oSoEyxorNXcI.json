{"data":{"site":{"siteMetadata":{"title":"Random Stuff About Stuff","author":"David Kerwick"}},"markdownRemark":{"id":"c54c1520-7966-550b-8af8-3dab7a5d8d9c","excerpt":"Following on from  Creating a better Docker Mysql  I also needed a proper php server.\nThis will be based off the official php Docker image, it needs to connect…","html":"<p>Following on from <a href=\"../2016-04-06-creating-a-better-docker-mysql\">Creating a better Docker Mysql</a> I also needed a proper php server.\nThis will be based off the official php Docker image, it needs to connect to mysql so needs the drivers set up for that and I think installing xdebug is a good idea as well.</p>\n<p>So I’ll start with the Dockerfile</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">FROM</span> php<span class=\"token punctuation\">:</span><span class=\"token number\">5.6</span><span class=\"token number\">.19</span><span class=\"token operator\">-</span>apache\n<span class=\"token constant\">RUN</span> apt<span class=\"token operator\">-</span>get update  \\\n  <span class=\"token operator\">&amp;&amp;</span> apt<span class=\"token operator\">-</span>get install <span class=\"token operator\">-</span>y php5<span class=\"token operator\">-</span>mysql \\\n  <span class=\"token operator\">&amp;&amp;</span> docker<span class=\"token operator\">-</span>php<span class=\"token operator\">-</span>ext<span class=\"token operator\">-</span>install mysql \\\n  <span class=\"token operator\">&amp;&amp;</span> pecl install xdebug\n<span class=\"token constant\">RUN</span> echo <span class=\"token string\">\"zend_extension=$(find /usr/local/lib/php/extensions/ -name xdebug.so)\"</span> <span class=\"token operator\">></span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>php<span class=\"token operator\">/</span>conf<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>xdebug<span class=\"token punctuation\">.</span>ini \\\n  <span class=\"token operator\">&amp;&amp;</span> echo <span class=\"token string\">\"xdebug.remote_enable=true\"</span> <span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>php<span class=\"token operator\">/</span>conf<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>xdebug<span class=\"token punctuation\">.</span>ini \\\n  <span class=\"token operator\">&amp;&amp;</span> echo <span class=\"token string\">\"xdebug.remote_autostart=1\"</span> <span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>php<span class=\"token operator\">/</span>conf<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>xdebug<span class=\"token punctuation\">.</span>ini \\\n  <span class=\"token operator\">&amp;&amp;</span> echo <span class=\"token string\">\"xdebug.remote_host=192.168.208.95\"</span> <span class=\"token operator\">></span><span class=\"token operator\">></span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>php<span class=\"token operator\">/</span>conf<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>xdebug<span class=\"token punctuation\">.</span>ini \\\n<span class=\"token constant\">RUN</span> a2enmod rewrite</code></pre></div>\n<p>So I’ll go through that by line number</p>\n<ol>\n<li>The base image to base off</li>\n<li>Start of a set of RUN commands to install items into this image, start with doing an apt-get update.  The <code class=\"language-text\">\\</code> is the continuation character that allows this run command to be split over several lines</li>\n<li>Install the mysql php client</li>\n<li>Use the script built into the base image to setup mysql for php</li>\n<li>Install xdebug</li>\n<li>Another RUN command to set up the xdebug config. This finds the <code class=\"language-text\">xdebug.so</code> line 5 installed and adds it an xdebug.ini file</li>\n<li>Enable remote debugging in the config file</li>\n<li>Start debugging </li>\n<li>Set the host (this is the ip of your client machine, ideally would want a way of dynamically setting that)</li>\n<li>Another RUN command to install mod rewrite</li>\n</ol>","frontmatter":{"title":"Creating a better docker php","date":"April 07, 2016"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2016-04-07-creating-a-better-docker-php/","previous":{"fields":{"slug":"/2016-04-07-setting-up-xdebug/"},"frontmatter":{"title":"Setting up Xdebug for PHP"}},"next":{"fields":{"slug":"/2016-04-07-docker-tying-a-php-server-and-mysql-server-together-for-development/"},"frontmatter":{"title":"Docker tying a php server and mysql server together for development"}}}}