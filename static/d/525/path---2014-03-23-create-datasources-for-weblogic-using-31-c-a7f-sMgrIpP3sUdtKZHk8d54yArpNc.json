{"data":{"site":{"siteMetadata":{"title":"Random Stuff About Stuff","author":"David Kerwick"}},"markdownRemark":{"id":"febaac3c-ef51-5907-a669-7692b8b3b41d","excerpt":"If you are flattening your dev Weblogic server regularly you might want to have your datasources in a wlst file so you can re run it every time.   Here is oneâ€¦","html":"<p>If you are flattening your dev Weblogic server regularly you might want to have your datasources in a wlst file so you can re run it every time.  </p>\n<p>Here is one you can use as the basis  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>  \n    <span class=\"token keyword\">from</span> wlstModule <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>  \n\n<span class=\"token keyword\">print</span> <span class=\"token string\">'Starting the  create datasource script ....'</span>  \n<span class=\"token comment\">#connect to the Adminserver  </span>\nconnect<span class=\"token punctuation\">(</span><span class=\"token string\">'weblogic'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'weblogic1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'t3://myhost.mydomain.ie:7001'</span><span class=\"token punctuation\">)</span>  \n<span class=\"token comment\">#switch to the cluster  </span>\ncd<span class=\"token punctuation\">(</span><span class=\"token string\">\"/Clusters/my-cluster\"</span><span class=\"token punctuation\">)</span>  \n<span class=\"token comment\">#record the cluster a variable for later use  </span>\ntarget <span class=\"token operator\">=</span> cmo  \n<span class=\"token comment\">#return to the root  </span>\ncd<span class=\"token punctuation\">(</span><span class=\"token string\">\"../..\"</span><span class=\"token punctuation\">)</span>  \n\n<span class=\"token comment\">#method to create a datasource with generic settings  </span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">create_datasource</span><span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> jndiList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  \n    <span class=\"token keyword\">print</span> <span class=\"token string\">'Creating a data source with name '</span> <span class=\"token operator\">+</span> username  \n    <span class=\"token comment\">#Create a datasource using the username as the name  </span>\n    jdbcSystemResource <span class=\"token operator\">=</span> create<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> <span class=\"token string\">\"JDBCSystemResource\"</span><span class=\"token punctuation\">)</span>  \n    jdbcResource <span class=\"token operator\">=</span> jdbcSystemResource<span class=\"token punctuation\">.</span>getJDBCResource<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n    jdbcResource<span class=\"token punctuation\">.</span>setName<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span>  \n\n    <span class=\"token comment\">#set the connection properties  </span>\n    connectionPoolParams <span class=\"token operator\">=</span> jdbcResource<span class=\"token punctuation\">.</span>getJDBCConnectionPoolParams<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n    connectionPoolParams<span class=\"token punctuation\">.</span>setConnectionReserveTimeoutSeconds<span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span>  \n    connectionPoolParams<span class=\"token punctuation\">.</span>setInitialCapacity<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>  \n    connectionPoolParams<span class=\"token punctuation\">.</span>setMaxCapacity<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>  \n    connectionPoolParams<span class=\"token punctuation\">.</span>setTestConnectionsOnReserve<span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span>  \n    connectionPoolParams<span class=\"token punctuation\">.</span>setHighestNumWaiters<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span>  \n    connectionPoolParams<span class=\"token punctuation\">.</span>setStatementTimeout<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>  \n    connectionPoolParams<span class=\"token punctuation\">.</span>setTestTableName<span class=\"token punctuation\">(</span><span class=\"token string\">\"SQL SELECT 1 FROM DUAL\"</span><span class=\"token punctuation\">)</span>  \n\n    <span class=\"token comment\">#add each element in the jndiList array as a jndi name  </span>\n    dsParams <span class=\"token operator\">=</span> jdbcResource<span class=\"token punctuation\">.</span>getJDBCDataSourceParams<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n    <span class=\"token keyword\">for</span> jndi <span class=\"token keyword\">in</span> jndiList<span class=\"token punctuation\">:</span>  \n      <span class=\"token keyword\">print</span> <span class=\"token string\">'Add jndi '</span> <span class=\"token operator\">+</span> jndi <span class=\"token operator\">+</span> <span class=\"token string\">' to datasource '</span> <span class=\"token operator\">+</span> username  \n      dsParams<span class=\"token punctuation\">.</span>addJndiName<span class=\"token punctuation\">(</span>jndi<span class=\"token punctuation\">)</span>  \n\n    <span class=\"token comment\">#Set the connection to the database  </span>\n    driverParams <span class=\"token operator\">=</span> jdbcResource<span class=\"token punctuation\">.</span>getJDBCDriverParams<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n    driverParams<span class=\"token punctuation\">.</span>setUrl<span class=\"token punctuation\">(</span><span class=\"token string\">\"jdbc:oracle:thin:@your_db_hostname:1521:your_db_server_name\"</span><span class=\"token punctuation\">)</span>  \n    driverParams<span class=\"token punctuation\">.</span>setDriverName<span class=\"token punctuation\">(</span><span class=\"token string\">\"oracle.jdbc.driver.OracleDriver\"</span><span class=\"token punctuation\">)</span>  \n    driverParams<span class=\"token punctuation\">.</span>setPassword<span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">)</span>  \n\n    driverProperties <span class=\"token operator\">=</span> driverParams<span class=\"token punctuation\">.</span>getProperties<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n    proper <span class=\"token operator\">=</span> driverProperties<span class=\"token punctuation\">.</span>createProperty<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">)</span>  \n    proper<span class=\"token punctuation\">.</span>setValue<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span>  \n\n    <span class=\"token comment\">#target the new datasource to your cluster  </span>\n    jdbcSystemResource<span class=\"token punctuation\">.</span>addTarget<span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span>  \n\nedit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \nstartEdit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n\n<span class=\"token comment\">#create an array for the datasource  </span>\njndiList<span class=\"token operator\">=</span><span class=\"token string\">'jdbc/whatever'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'jdbc/whomever'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'jdbc/etc'</span>  \ncreate_datasource<span class=\"token punctuation\">(</span><span class=\"token string\">'who_ds'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'who_ds_pw'</span><span class=\"token punctuation\">,</span> jndiList<span class=\"token punctuation\">)</span>  \n\n<span class=\"token comment\">#create an array for the datasource  </span>\njndiList<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'jdbc/curly'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'jdbc/larry'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'jdbc/moe'</span><span class=\"token punctuation\">]</span>  \ncreate_datasource<span class=\"token punctuation\">(</span><span class=\"token string\">'stooges'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'stooges_pw'</span><span class=\"token punctuation\">,</span> jndiList<span class=\"token punctuation\">)</span>  \n\nsave<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \nactivate<span class=\"token punctuation\">(</span>block<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span><span class=\"token punctuation\">)</span>  \n\n<span class=\"token keyword\">print</span> <span class=\"token string\">'Finished configuring the data source'</span>  </code></pre></div>","frontmatter":{"title":"Create datasources for weblogic using WLST","date":"March 23, 2014"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2014-03-23-create-datasources-for-weblogic-using/","previous":{"fields":{"slug":"/2014-03-20-weblogic-linking-machine-and-cluster/"},"frontmatter":{"title":"Weblogic linking machine and cluster using WLST"}},"next":{"fields":{"slug":"/2014-03-23-problems-when-starting-weblogic-admin/"},"frontmatter":{"title":"Problems when starting the Weblogic admin server"}}}}