---
layout: post
title: Oracle Update Rows With Random Values From A Set
date: '2015-01-06T16:28:00.001Z'
author: David
tags: 
modified_time: '2015-01-06T16:28:28.185Z'
blogger_id: tag:blogger.com,1999:blog-2027514548288128942.post-8682101546839001104
blogger_orig_url: http://davidkerwick.blogspot.com/2015/01/oracle-update-rows-with-random-values.html
---

So I had to update a table on Oracle and set one of the values to a random value, but that value had to be from a set of fixed values.<br /><br />I was looking at doing something based on the row number, perhaps all the rows starting with 1 get value X, etc...<br /><br />But that wasn't very random but would distribute pretty well, in blocks anyway.<br /><br />So I think combining DECODE and DBMS_RANDOM is the best solution.<br /><br />Random can give us a random number within a range, say 1-6<br /><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">select</span> dbms_random.value(<span style="color: #0000dd; font-weight: bold;">1</span>,<span style="color: #0000dd; font-weight: bold;">7</span>) rand_num <span style="color: #008800; font-weight: bold;">from</span> dual;<br /><br />rand_num<br /><span style="color: #0000dd; font-weight: bold;">5</span>.<span style="color: #0000dd; font-weight: bold;">77115198323733</span><br /></pre></td></tr></tbody></table></div><br />We will need a whole number though<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">select</span> trunc(dbms_random.value(<span style="color: #0000dd; font-weight: bold;">1</span>,<span style="color: #0000dd; font-weight: bold;">7</span>)) rand_num <span style="color: #008800; font-weight: bold;">from</span> dual;<br /><br />rand_num<br /><span style="color: #0000dd; font-weight: bold;">5</span>.<span style="color: #0000dd; font-weight: bold;">77115198323733</span><br /></pre></td></tr></tbody></table></div><br />round might seem tempting but won't distribute evenly<br /><br />Next we can use the decode statement which acts like an if-elseif-else block<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4<br />5<br />6<br />7</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">select</span> decode( trunc(dbms_random.value(<span style="color: #0000dd; font-weight: bold;">1</span>,<span style="color: #0000dd; font-weight: bold;">7</span>)),<br /><span style="color: #0000dd; font-weight: bold;">1</span>,<span style="background-color: #fff0f0;">'Some value 1'</span>,<br /><span style="color: #0000dd; font-weight: bold;">2</span>,<span style="background-color: #fff0f0;">'Some value 2'</span>,<br /><span style="color: #0000dd; font-weight: bold;">3</span>,<span style="background-color: #fff0f0;">'Some value 3'</span>,<br /><span style="color: #0000dd; font-weight: bold;">4</span>,<span style="background-color: #fff0f0;">'Some value 4'</span>,<br /><span style="color: #0000dd; font-weight: bold;">5</span>,<span style="background-color: #fff0f0;">'Some value 5'</span>,<br /><span style="background-color: #fff0f0;">'Default value'</span>) <span style="color: #008800; font-weight: bold;">from</span> dual;<br /></pre></td></tr></tbody></table></div><br />Not the greatest set of values but shows what happens. <br />The random statement picks a value between 1 and 6.<br />The decode statement then picks the string associated with this number, '6' is not defined but the default value picks that up.<br /><br />So in the end the update statement would look something like this<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4<br />5<br />6<br />7</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">update</span> some_table <span style="color: #008800; font-weight: bold;">set</span> some_value <span style="color: #333333;">=</span> decode( trunc(dbms_random.value(<span style="color: #0000dd; font-weight: bold;">1</span>,<span style="color: #0000dd; font-weight: bold;">7</span>)),<br /><span style="color: #0000dd; font-weight: bold;">1</span>,<span style="background-color: #fff0f0;">'Some value 1'</span>,<br /><span style="color: #0000dd; font-weight: bold;">2</span>,<span style="background-color: #fff0f0;">'Some value 2'</span>,<br /><span style="color: #0000dd; font-weight: bold;">3</span>,<span style="background-color: #fff0f0;">'Some value 3'</span>,<br /><span style="color: #0000dd; font-weight: bold;">4</span>,<span style="background-color: #fff0f0;">'Some value 4'</span>,<br /><span style="color: #0000dd; font-weight: bold;">5</span>,<span style="background-color: #fff0f0;">'Some value 5'</span>,<br /><span style="background-color: #fff0f0;">'Default value'</span>);<br /></pre></td></tr></tbody></table></div><br /><br />