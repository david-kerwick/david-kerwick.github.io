---
layout: post
title: Getting Oracle Sequences in bulk
date: '2015-01-19T22:06:00.002Z'
author: David
tags: 
modified_time: '2015-01-19T22:13:33.053Z'
blogger_id: tag:blogger.com,1999:blog-2027514548288128942.post-7239561773211785317
blogger_orig_url: http://davidkerwick.blogspot.com/2015/01/getting-oracle-sequences-in-bulk.html
---

So following on from getting <a href="http://davidkerwick.blogspot.ie/2015/01/getting-oracle-sequence-in-spring.html">one value from a sequence</a>&nbsp;what if you want to get alot of sequences in bulk. &nbsp;So you could get them as and when you need them or you could loop the number of times to need and call the OracleSequenceMaxValueIncrementer each time.<br /><br />Depending on the amount you need you may find this pretty slow as at the end of the day it's a database call each time and there's a cost to that that adds up.<br /><br />So how to get them in bulk, it would be good if a sequence gave you a list if you asked for it but that doesn't seem to be there yet. &nbsp;So how about we cheat a bit<br /><br />select message_id.nextval from dual connect by level &lt;= 50;<br /><div><br /></div><div>Will give you 50 values from the sequence. &nbsp;Happy days, so leave it at that right... No?</div><div>Well I have to say if I was asked to explain it fully in an interrogation room under a swinging lamp I would be hard pressed.</div><div><br /></div><div>It uses hierarchal queries but not strictly correctly, there's none of the other supporting stuff like 'start with' and 'prior' so it causes it to act like a recursion. &nbsp;So I assume really large values will blow it up but several thousand should be fine.</div><div><br /></div><div>And one database and network round trip = fast to don't over think it :)</div><div>An example class that does this would be<br /><br /><br /></div><pre style="background: #fff; color: #3b3b3b;"><span style="color: #006699; font-weight: 700;">import</span> <span style="color: #ff5600;">java.util.List</span>;<br /><br /><span style="color: #006699; font-weight: 700;">import</span> <span style="color: #ff5600;">javax.sql.DataSource</span>;<br /><br /><span style="color: #006699; font-weight: 700;">import</span> <span style="color: #ff5600;">org.slf4j.Logger</span>;<br /><span style="color: #006699; font-weight: 700;">import</span> <span style="color: #ff5600;">org.springframework.beans.factory.annotation.Autowired</span>;<br /><span style="color: #006699; font-weight: 700;">import</span> <span style="color: #ff5600;">org.springframework.jdbc.core.namedparam.MapSqlParameterSource</span>;<br /><span style="color: #006699; font-weight: 700;">import</span> <span style="color: #ff5600;">org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate</span>;<br /><span style="color: #006699; font-weight: 700;">import</span> <span style="color: #ff5600;">org.springframework.stereotype.Repository</span>;<br /><br />@<span style="color: #ff5600;">Repository</span><br /><span style="color: #ff5600;">public</span> <span style="color: #ff5600;">class</span> <span style="color: #21439c;">MessageIdSeqBulkImpl</span> <span style="color: #ff5600;">implements</span> MessageIdSeqBulk {<br />    <span style="color: #ff5600;">private</span> <span style="color: #ff5600;">transient</span> <span style="color: #ff5600;">NamedParameterJdbcTemplate</span> namedTemplate;<br /><br />      <span style="color: #ff5600;">@Autowired</span><br />    <span style="color: #ff5600;">public</span> <span style="color: #ff5600;">void</span> <span style="color: #21439c;">setDataSource</span>(<span style="color: #ff5600;">DataSource</span> <span style="color: #0053ff; font-weight: 700;">dataSource</span>) {<br />        <span style="color: #0053ff; font-weight: 700;">this</span><span style="color: #006699; font-weight: 700;">.</span>namedTemplate <span style="color: #006699; font-weight: 700;">=</span> <span style="color: #006699; font-weight: 700;">new</span> <span style="color: #ff5600;">NamedParameterJdbcTemplate</span>(dataSource);<br />    }<br /><br />    <span style="color: #ff5600;">@Override</span><br />    <span style="color: #ff5600;">public</span> <span style="color: #ff5600;">List&lt;<span style="color: #ff5600;">Integer</span>&gt;</span> <span style="color: #21439c;">getBulkMessageId</span>(<span style="color: #ff5600;">int</span> <span style="color: #0053ff; font-weight: 700;">count</span>) {<br />        <span style="color: #ff5600;">MapSqlParameterSource</span> paramSource <span style="color: #006699; font-weight: 700;">=</span> <span style="color: #006699; font-weight: 700;">new</span> <span style="color: #ff5600;">MapSqlParameterSource</span>(<span style="color: #666666;">"count"</span>, count);<br />        <span style="color: #006699; font-weight: 700;">return</span> <span style="color: #0053ff; font-weight: 700;">this</span><span style="color: #006699; font-weight: 700;">.</span>namedTemplate<span style="color: #006699; font-weight: 700;">.</span>queryForList(“select message_id<span style="color: #006699; font-weight: 700;">.</span>nextval from dual connect by level <span style="color: #006699; font-weight: 700;">&lt;=</span> <span style="color: #006699; font-weight: 700;">:</span>count<br />”, paramSource, <span style="color: #ff5600;">Integer</span><span style="color: #006699; font-weight: 700;">.</span>class);<br />    }<br />}<br /><br /></pre>