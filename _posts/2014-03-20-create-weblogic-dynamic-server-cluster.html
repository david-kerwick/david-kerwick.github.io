---
layout: post
title: Create a Weblogic dynamic server cluster using WLST
date: '2014-03-20T23:06:00.002Z'
author: David
tags:
- wlst
- weblogic
modified_time: '2014-04-03T22:42:07.822+01:00'
blogger_id: tag:blogger.com,1999:blog-2027514548288128942.post-6230491799187399695
blogger_orig_url: http://davidkerwick.blogspot.com/2014/03/create-weblogic-dynamic-server-cluster.html
---

<br />Continuing my little series of posts on using wlst, <a href="http://davidkerwick.blogspot.ie/2014/03/create-new-weblogic-domain-using-wlst.html">how to create a domain</a> and <a href="http://davidkerwick.blogspot.ie/2014/03/create-machine-for-weblogic-with-wlst.html">how to add a machine</a>&nbsp;the below will set up a dynamic server cluster. &nbsp;This is a new feature for Weblogic 12C 12.1.2.<br /><div><br /></div><div>You can find more details on the dynamic cluster <a href="http://docs.oracle.com/middleware/1212/wls/INTRO/clustering.htm#BABJGIBI">here</a>. &nbsp;In brief it allows you to grow and shrink the number of available managed servers, with each managed server based on a template.</div><div><br /></div><pre class="brush: python">if __name__ == '__main__':<br />    from wlstModule import *<br /><br />connect('weblogic', 'weblogic1', 't3://myhost.mydomain.ie:7001')<br />edit()<br />startEdit()<br /><br />dynamicServerTemplate = cmo.createServerTemplate('my-server-template')<br />dynamicServerTemplate.setAcceptBacklog(2000)<br />dynamicServerTemplate.setAutoRestart(true)<br />dynamicServerTemplate.setRestartMax(1)<br />dynamicServerTemplate.setStartupTimeout(600)<br />dynamicServerTemplate.setAutoKillIfFailed(true)<br />dynamicServerTemplate.getOverloadProtection().setFailureAction('force-shutdown')<br />dynamicServerTemplate.getOverloadProtection().setPanicAction('system-exit')<br /># Set whatever settings best suit the memory on the system and what you what to do with this server<br />#I believe MaxPermSize should be half the max heap<br />#The urandom is covered in another post<br />dynamicServerTemplate.getServerStart().setArguments(<br />    '-Xmx2048m -Xms2048m -XX:+UseG1GC -XX:MaxPermSize=1024m -Djava.security.egd=file:///dev/./urandom')<br />dynamicServerTemplate.getLog().setFileName('${serverName}_%yyyy%_%MM%_%dd%_%hhmm%.log')<br />dynamicServerTemplate.getLog().setRotationType('byTime')<br />dynamicServerTemplate.getLog().setRedirectStderrToServerLogEnabled(true)<br />dynamicServerTemplate.getLog().setRedirectStdoutToServerLogEnabled(true)<br />dynamicServerTemplate.getWebServer().getWebServerLog().setFileName('${serverName}_access_%yyyy%_%MM%_%dd%_%hhmm%.log')<br />dynamicServerTemplate.getWebServer().getWebServerLog().setRotationType('byTime')<br /><br />dynCluster = cmo.createCluster('my-cluster')<br />dynCluster.getOverloadProtection().setFailureAction('force-shutdown')<br />dynCluster.getOverloadProtection().setPanicAction('system-exit')<br />dynServers = dynCluster.getDynamicServers()<br />dynServers.setMaximumDynamicServerCount(1)<br />dynServers.setServerTemplate(dynamicServerTemplate)<br /><br />dynServers.setServerNamePrefix('my-server-')<br /><br />dynServers.setCalculatedMachineNames(true)<br />dynServers.setCalculatedListenPorts(true)<br /><br />activate(block="true")<br /><br />exit()<br /><br /></pre><div><br />One thing worth mentioning a bit more is the log file names.<br />As the servers an dynamically created based on the prefix, in this case my-server-1, my-server-2, etc... you can use a variable made available by Weblogic ${serverName} which will have this dynamically created name.<br />The filepattern can be of your choosing and is used when the log files are rotated, the pattern replaced with the actual date values.<br />So for example the logs for my-server--1 would be<br />my-server-1_yyyy_MM_dd_hhmm.log<br />Bit of an eye full, but when rotated the old one becomes<br />my-server-1_2014_03_20_0000.log<br />Which I find better than the sequence number which is the default</div>